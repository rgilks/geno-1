<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Generative 3D Music Visualizer (Web)</title>
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        background: #020308;
      }
      #app-canvas {
        width: 100vw;
        height: 100vh;
        display: block;
      }
      .hint {
        position: fixed;
        left: 12px;
        bottom: 12px;
        color: #9bb;
        font: 12px/1.3 monospace;
        opacity: 0.8;
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "env": "./pkg/env.js"
        }
      }
    </script>
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E"
    />
  </head>
  <body>
    <canvas id="app-canvas" width="1280" height="720"></canvas>
    <div class="hint">Click the canvas to start audio</div>
    <div
      id="no-webgpu"
      style="
        display: none;
        color: #caa;
        font: 14px/1.4 system-ui;
        position: fixed;
        left: 12px;
        top: 12px;
        max-width: 560px;
        background: rgba(20, 20, 30, 0.7);
        padding: 10px 12px;
        border-radius: 6px;
      "
    >
      This demo requires WebGPU. Your browser either does not support it or it
      is disabled.<br />
      Try Chrome 113+ or Edge 113+ with WebGPU enabled.
    </div>
    <script type="module">
      const v = Date.now();
      console.log("[index] dynamic import cache-bust tag:", v);
      if (!("gpu" in navigator)) {
        const el = document.getElementById("no-webgpu");
        if (el) el.style.display = "block";
      }
      import(`./pkg/app_web.js?v=${v}`).then((m) => {
        console.log(
          "[index] wasm entry loaded url:",
          new URL(`./pkg/app_web.js?v=${v}`, window.location.href).toString()
        );
        return m.default();
      });
    </script>
  </body>
</html>
